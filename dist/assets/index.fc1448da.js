const re=function(){const p=document.createElement("link").relList;if(p&&p.supports&&p.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))t(f);new MutationObserver(f=>{for(const a of f)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&t(c)}).observe(document,{childList:!0,subtree:!0});function l(f){const a={};return f.integrity&&(a.integrity=f.integrity),f.referrerpolicy&&(a.referrerPolicy=f.referrerpolicy),f.crossorigin==="use-credentials"?a.credentials="include":f.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function t(f){if(f.ep)return;f.ep=!0;const a=l(f);fetch(f.href,a)}};re();var oe=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function ie(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var J={};Object.defineProperty(J,"__esModule",{value:!0});var ae=function(){function s(){this.seperator=","}return s.prototype.correctFormat=function(p){var l=p.replace(".",","),t=null,f=null,a=null,c=null,e=l.split(","),n=e[0],r=e[1];c=this.fixed_str_digit(3,r);var g=n.split(":"),S=g[0],b=g[1],x=g[2];return t=this.fixed_str_digit(2,S,!1),f=this.fixed_str_digit(2,b,!1),a=this.fixed_str_digit(2,x,!1),t+":"+f+":"+a+","+c},s.prototype.fixed_str_digit=function(p,l,t){if(t===void 0&&(t=!0),l.length==p)return l;if(l.length>p)return l.slice(0,p);if(l.length<p)return t?l.padEnd(p,"0"):l.padStart(p,"0")},s.prototype.tryComma=function(p){p=p.replace(/\r/g,"");var l=/(\d+)\n(\d{1,2}:\d{2}:\d{2},\d{1,3}) --> (\d{1,2}:\d{2}:\d{2},\d{1,3})/g,t=p.split(l);return t.shift(),t},s.prototype.tryDot=function(p){p=p.replace(/\r/g,"");var l=/(\d+)\n(\d{1,2}:\d{2}:\d{2}\.\d{1,3}) --> (\d{1,2}:\d{2}:\d{2}\.\d{1,3})/g,t=p.split(l);return t.shift(),this.seperator=".",t},s.prototype.fromSrt=function(p){var l=p,t=this.tryComma(l);t.length==0&&(t=this.tryDot(l));for(var f=[],a=0;a<t.length;a+=4){var c={id:t[a].trim(),startTime:this.correctFormat(t[a+1].trim()),endTime:this.correctFormat(t[a+2].trim()),text:t[a+3].trim()};f.push(c)}return f},s.prototype.toSrt=function(p){for(var l="",t=0;t<p.length;t++){var f=p[t];l+=f.id+`\r
`,l+=f.startTime+" --> "+f.endTime+`\r
`,l+=f.text.replace(`
`,`\r
`)+`\r
\r
`}return l},s}(),le=J.default=ae,q={exports:{}};/*!
 * clipboard.js v2.0.11
 * https://clipboardjs.com/
 *
 * Licensed MIT © Zeno Rocha
 */(function(s,p){(function(t,f){s.exports=f()})(oe,function(){return function(){var l={686:function(a,c,e){e.d(c,{default:function(){return ne}});var n=e(279),r=e.n(n),g=e(370),S=e.n(g),b=e(817),x=e.n(b);function v(m){try{return document.execCommand(m)}catch{return!1}}var T=function(i){var o=x()(i);return v("cut"),o},h=T;function _(m){var i=document.documentElement.getAttribute("dir")==="rtl",o=document.createElement("textarea");o.style.fontSize="12pt",o.style.border="0",o.style.padding="0",o.style.margin="0",o.style.position="absolute",o.style[i?"right":"left"]="-9999px";var u=window.pageYOffset||document.documentElement.scrollTop;return o.style.top="".concat(u,"px"),o.setAttribute("readonly",""),o.value=m,o}var j=function(i,o){var u=_(i);o.container.appendChild(u);var d=x()(u);return v("copy"),u.remove(),d},z=function(i){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body},u="";return typeof i=="string"?u=j(i,o):i instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(i==null?void 0:i.type)?u=j(i.value,o):(u=x()(i),v("copy")),u},O=z;function I(m){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?I=function(o){return typeof o}:I=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},I(m)}var U=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=i.action,u=o===void 0?"copy":o,d=i.container,y=i.target,w=i.text;if(u!=="copy"&&u!=="cut")throw new Error('Invalid "action" value, use either "copy" or "cut"');if(y!==void 0)if(y&&I(y)==="object"&&y.nodeType===1){if(u==="copy"&&y.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if(u==="cut"&&(y.hasAttribute("readonly")||y.hasAttribute("disabled")))throw new Error(`Invalid "target" attribute. You can't cut text from elements with "readonly" or "disabled" attributes`)}else throw new Error('Invalid "target" value, use a valid Element');if(w)return O(w,{container:d});if(y)return u==="cut"?h(y):O(y,{container:d})},Y=U;function A(m){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?A=function(o){return typeof o}:A=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},A(m)}function V(m,i){if(!(m instanceof i))throw new TypeError("Cannot call a class as a function")}function H(m,i){for(var o=0;o<i.length;o++){var u=i[o];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(m,u.key,u)}}function G(m,i,o){return i&&H(m.prototype,i),o&&H(m,o),m}function X(m,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");m.prototype=Object.create(i&&i.prototype,{constructor:{value:m,writable:!0,configurable:!0}}),i&&C(m,i)}function C(m,i){return C=Object.setPrototypeOf||function(u,d){return u.__proto__=d,u},C(m,i)}function K(m){var i=ee();return function(){var u=k(m),d;if(i){var y=k(this).constructor;d=Reflect.construct(u,arguments,y)}else d=u.apply(this,arguments);return Q(this,d)}}function Q(m,i){return i&&(A(i)==="object"||typeof i=="function")?i:Z(m)}function Z(m){if(m===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m}function ee(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function k(m){return k=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)},k(m)}function R(m,i){var o="data-clipboard-".concat(m);if(!!i.hasAttribute(o))return i.getAttribute(o)}var te=function(m){X(o,m);var i=K(o);function o(u,d){var y;return V(this,o),y=i.call(this),y.resolveOptions(d),y.listenClick(u),y}return G(o,[{key:"resolveOptions",value:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.action=typeof d.action=="function"?d.action:this.defaultAction,this.target=typeof d.target=="function"?d.target:this.defaultTarget,this.text=typeof d.text=="function"?d.text:this.defaultText,this.container=A(d.container)==="object"?d.container:document.body}},{key:"listenClick",value:function(d){var y=this;this.listener=S()(d,"click",function(w){return y.onClick(w)})}},{key:"onClick",value:function(d){var y=d.delegateTarget||d.currentTarget,w=this.action(y)||"copy",F=Y({action:w,container:this.container,target:this.target(y),text:this.text(y)});this.emit(F?"success":"error",{action:w,text:F,trigger:y,clearSelection:function(){y&&y.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(d){return R("action",d)}},{key:"defaultTarget",value:function(d){var y=R("target",d);if(y)return document.querySelector(y)}},{key:"defaultText",value:function(d){return R("text",d)}},{key:"destroy",value:function(){this.listener.destroy()}}],[{key:"copy",value:function(d){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body};return O(d,y)}},{key:"cut",value:function(d){return h(d)}},{key:"isSupported",value:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["copy","cut"],y=typeof d=="string"?[d]:d,w=!!document.queryCommandSupported;return y.forEach(function(F){w=w&&!!document.queryCommandSupported(F)}),w}}]),o}(r()),ne=te},828:function(a){var c=9;if(typeof Element!="undefined"&&!Element.prototype.matches){var e=Element.prototype;e.matches=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector}function n(r,g){for(;r&&r.nodeType!==c;){if(typeof r.matches=="function"&&r.matches(g))return r;r=r.parentNode}}a.exports=n},438:function(a,c,e){var n=e(828);function r(b,x,v,T,h){var _=S.apply(this,arguments);return b.addEventListener(v,_,h),{destroy:function(){b.removeEventListener(v,_,h)}}}function g(b,x,v,T,h){return typeof b.addEventListener=="function"?r.apply(null,arguments):typeof v=="function"?r.bind(null,document).apply(null,arguments):(typeof b=="string"&&(b=document.querySelectorAll(b)),Array.prototype.map.call(b,function(_){return r(_,x,v,T,h)}))}function S(b,x,v,T){return function(h){h.delegateTarget=n(h.target,x),h.delegateTarget&&T.call(b,h)}}a.exports=g},879:function(a,c){c.node=function(e){return e!==void 0&&e instanceof HTMLElement&&e.nodeType===1},c.nodeList=function(e){var n=Object.prototype.toString.call(e);return e!==void 0&&(n==="[object NodeList]"||n==="[object HTMLCollection]")&&"length"in e&&(e.length===0||c.node(e[0]))},c.string=function(e){return typeof e=="string"||e instanceof String},c.fn=function(e){var n=Object.prototype.toString.call(e);return n==="[object Function]"}},370:function(a,c,e){var n=e(879),r=e(438);function g(v,T,h){if(!v&&!T&&!h)throw new Error("Missing required arguments");if(!n.string(T))throw new TypeError("Second argument must be a String");if(!n.fn(h))throw new TypeError("Third argument must be a Function");if(n.node(v))return S(v,T,h);if(n.nodeList(v))return b(v,T,h);if(n.string(v))return x(v,T,h);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function S(v,T,h){return v.addEventListener(T,h),{destroy:function(){v.removeEventListener(T,h)}}}function b(v,T,h){return Array.prototype.forEach.call(v,function(_){_.addEventListener(T,h)}),{destroy:function(){Array.prototype.forEach.call(v,function(_){_.removeEventListener(T,h)})}}}function x(v,T,h){return r(document.body,v,T,h)}a.exports=g},817:function(a){function c(e){var n;if(e.nodeName==="SELECT")e.focus(),n=e.value;else if(e.nodeName==="INPUT"||e.nodeName==="TEXTAREA"){var r=e.hasAttribute("readonly");r||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),r||e.removeAttribute("readonly"),n=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var g=window.getSelection(),S=document.createRange();S.selectNodeContents(e),g.removeAllRanges(),g.addRange(S),n=g.toString()}return n}a.exports=c},279:function(a){function c(){}c.prototype={on:function(e,n,r){var g=this.e||(this.e={});return(g[e]||(g[e]=[])).push({fn:n,ctx:r}),this},once:function(e,n,r){var g=this;function S(){g.off(e,S),n.apply(r,arguments)}return S._=n,this.on(e,S,r)},emit:function(e){var n=[].slice.call(arguments,1),r=((this.e||(this.e={}))[e]||[]).slice(),g=0,S=r.length;for(g;g<S;g++)r[g].fn.apply(r[g].ctx,n);return this},off:function(e,n){var r=this.e||(this.e={}),g=r[e],S=[];if(g&&n)for(var b=0,x=g.length;b<x;b++)g[b].fn!==n&&g[b].fn._!==n&&S.push(g[b]);return S.length?r[e]=S:delete r[e],this}},a.exports=c,a.exports.TinyEmitter=c}},t={};function f(a){if(t[a])return t[a].exports;var c=t[a]={exports:{}};return l[a](c,c.exports,f),c.exports}return function(){f.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return f.d(c,{a:c}),c}}(),function(){f.d=function(a,c){for(var e in c)f.o(c,e)&&!f.o(a,e)&&Object.defineProperty(a,e,{enumerable:!0,get:c[e]})}}(),function(){f.o=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)}}(),f(686)}().default})})(q);var ce=ie(q.exports);const ue=new le,W=new ce("#copy");var $=document.getElementById("customBracketStyle"),B=document.getElementById("quoteReplace"),N=document.getElementById("aegisub"),M=document.getElementById("bracketStyle"),P=document.getElementById("spaceReplace");localStorage.removeItem("config");$.value=localStorage.getItem("customBracketStyle")!==null?localStorage.getItem("customBracketStyle"):"";B.checked=localStorage.getItem("quoteReplace")!==null?JSON.parse(localStorage.getItem("quoteReplace")):!1;N.checked=localStorage.getItem("aegisub")!==null?JSON.parse(localStorage.getItem("aegisub")):!1;M.checked=localStorage.getItem("bracketStyle")!==null?JSON.parse(localStorage.getItem("bracketStyle")):!0;P.checked=localStorage.getItem("spaceReplace")!==null?JSON.parse(localStorage.getItem("spaceReplace")):!1;D();console.log("\u8BFB\u53D6\u8BBE\u7F6E\uFF1A",localStorage);function D(){localStorage.setItem("customBracketStyle",$.value),localStorage.setItem("quoteReplace",B.checked),localStorage.setItem("aegisub",N.checked),localStorage.setItem("bracketStyle",M.checked),localStorage.setItem("spaceReplace",P.checked)}$.addEventListener("input",D);let se=[B,N,M,P];se.forEach(s=>{s.addEventListener("change",D)});W.on("success",function(s){E("\u590D\u5236\u7ED3\u679C\u6210\u529F")});W.on("error",function(s){E("\u590D\u5236\u7ED3\u679C\u5931\u8D25")});document.getElementById("download").addEventListener("click",()=>{let s=document.getElementById("ass").value;s!==""?fe(`Generated_${new Date().getTime()}.ass`,s):E("\u5C1A\u672A\u751F\u6210 ASS \u5185\u5BB9!",!0)});function fe(s,p){localStorage.getItem("aegisub")&&mdui.alert("\u867D\u7136\u4F46\u662F\uFF0C\u8FD9\u6837\u4E0B\u8F7D\u7684\u6587\u4EF6\u4E0D\u80FD\u7528\u5594... <br>\u60A8\u5DF2\u6253\u5F00 \u3010\u4EC5\u751F\u6210\u53EF\u7C98\u8D34\u81F3 Aegisub \u7684\u5185\u5BB9\u3011");var l=document.createElement("a");l.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(p)),l.setAttribute("download",s);var t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});l.dispatchEvent(t)}var L=document.getElementById("srt");document.ondrop=function(s){s.preventDefault()};document.ondragover=function(s){s.preventDefault()};L.ondragenter=function(){document.getElementById("srt-element-father").classList.add("mdui-textfield-focus")};L.ondragleave=function(){document.getElementById("srt-element-father").classList.remove("mdui-textfield-focus")};L.ondrop=function(s){var p=new FileReader;p.readAsText(s.dataTransfer.files[0]),p.onload=function(){L.value=p.result}};document.getElementById("go").addEventListener("click",()=>{let s=document.getElementById("srt").value,p=localStorage.getItem("customBracketStyle")!==""?localStorage.getItem("customBracketStyle"):"Top";if(s!==""){let l=de(s,p);document.getElementById("ass").value=l}else E("\u8BF7\u586B\u5165 SRT \u5B57\u5E55\u6B63\u6587",!0)});function E(s,p=!1){document.getElementById("log").insertAdjacentHTML("beforeend",s+"<br>"),console.log(s),p&&mdui.snackbar({message:s})}function de(s,p){let l=ue.fromSrt(s),t=new Array;for(let e in l)if(l[e].text.includes(`
`)){let n=l[e].text.split(`
`);E(`[\u62C6\u5206\u591A\u884C][${e}] ${JSON.stringify(n)}`);for(let r=0;r<n.length;r++){if(n[r].match(/\(|（/g)&&n[r].match(/\)|）/g)==null&&n[r+1].match(/\(|（/g)==null&&n[r+1].match(/\)|）/g)){let S={startTime:l[e].startTime,endTime:l[e].endTime,text:n[r],style:"Default",comment:!0},b={startTime:l[e].startTime,endTime:l[e].endTime,text:n[r+1],style:"Default",comment:!0};t.push(S,b),E(`[\u5408\u5E76\u8DE8\u884C\u62EC\u53F7][${e}] ${JSON.stringify([n[r],n[r+1]])}`),n[r]=n[r]+n[r+1],n.splice(r+1,1)}let g={startTime:l[e].startTime,endTime:l[e].endTime,text:n[r],style:"Default",comment:!1};t.push(g)}}else{let n={startTime:l[e].startTime,endTime:l[e].endTime,text:l[e].text,style:"Default",comment:!1};t.push(n)}for(let e in t){t[e].text.startsWith("-")&&t[e].text.split("-").length==2&&(E(`[\u5220\u9664\u6B8B\u7559\u6A2A\u6760][${e}] ${t[e].text} \u7684\u5F00\u5934\u662F - \u4E14\u662F\u4E00\u4E2A\u5355\u72EC\u5BF9\u8BDD\uFF0C\u79FB\u9664...`),t[e].text=t[e].text.replace(/^-/,""));let n=t[e].text.split("-");if(n.length>=3&&n[0]==""&&n[1]!=""&&n[2]!=""){E(`[\u5355\u884C\u591A\u91CD\u5BF9\u8BDD][\u884C ${e}] ${t[e].text} \u53EF\u80FD\u4E3A\u591A\u91CD\u5BF9\u8BDD\uFF0C\u51C6\u5907\u62C6\u5206`),n.splice(0,1);for(let r=0;r<n.length;r++){n[r]=n[r].trim(),E(`[\u5355\u884C\u591A\u91CD\u5BF9\u8BDD][\u884C ${e}] \u62C6\u5206\u5355\u884C(${r}): ${n[r]}`);let g={startTime:t[e].startTime,endTime:t[e].endTime,text:n[r],style:"Default",comment:!1};t.splice(parseInt(e)+1,0,g),t[e].comment=!0}}}for(let e in t)for(let n=0;n<t.length;n++)t[n].startTime==t[e].endTime&&t[n].text==t[e].text&&(t[e].comment||E(`[\u5408\u5E76\u5206\u88C2\u884C][${e} ==> ${n}](${t[e].endTime} => ${t[n].endTime}) ${t[n].text}`),t[e].endTime=t[n].endTime,t.splice(n,1),n=n-1);if(localStorage.getItem("bracketStyle")=="true")for(let e in t){let n=t[e].text;(n.startsWith("(")&&n.endsWith(")")||n.startsWith("\uFF08")&&n.endsWith("\uFF09"))&&(E(`[\u62EC\u53F7\u884C\u6837\u5F0F][\u884C ${e}] ${n} \u66F4\u6362\u4E3A ${p} \u6837\u5F0F`),t[e].style=p)}if(localStorage.getItem("spaceReplace")=="true")for(let e in t)t[e].text=t[e].text.replace(/ /g,"\u3000");if(localStorage.getItem("quoteReplace")=="true")for(let e in t)t[e].text.match(/\“|\”/)&&(t[e].comment||E(`[\u53D8\u6210\u65B9\u62EC\u53F7][${e}] ${t[e].text}`),t[e].text=t[e].text.replace(/“/g,"\u300C").replace(/”/g,"\u300D"));console.log("\u4E0B\u65B9\u662F\u6700\u7EC8\u7684\u5B57\u5E55\u6570\u7EC4\uFF1A"),console.log(t);let f=new Date,c=`[Script Info]
; Script generated by LavaAnimeSubTools
; Generate time: ${`${f.toLocaleString("zh-CN",{hour12:!1})} (${f.getTime()})`}
Title: New Subtitle
Original Script: LavaAnimeSubTools
ScriptType: v4.00+
WrapStyle: 0
ScaledBorderAndShadow: yes
PlayResX: 1920
PlayResY: 1080

[V4+ Styles]
Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding
Style: Default,\u963F\u91CC\u5DF4\u5DF4\u666E\u60E0\u4F53 M,81,&H00FFFFFF,&H00FFFFFF,&H002A2A2A,&HFF0E0807,0,0,0,0,100,100,1,0,1,3,0,2,135,135,32,1
Style: Top,\u963F\u91CC\u5DF4\u5DF4\u666E\u60E0\u4F53 B,64,&H00FFFFFF,&H00FFFFFF,&H000A0A0A,&HFF0E0807,0,0,0,0,100,100,1,0,1,3,0,8,135,135,20,1

[Events]
Format: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text
`;localStorage.getItem("aegisub")=="true"&&(c="");for(let e in t){let n=t[e].startTime.slice(1,11).replace(",","."),r=t[e].endTime.slice(1,11).replace(",","."),S=`${t[e].comment?"Comment":"Dialogue"}: 0,${n},${r},${t[e].style},,0,0,0,,${t[e].text}
`;c=c.concat(S)}return t.length==0?(E("\u6CA1\u6709\u53EF\u4EE5\u8F6C\u6362\u7684\u5B57\u5E55\uFF0C\u8BF7\u68C0\u67E5 SRT \u5185\u5BB9\uFF01",!0),""):c}
